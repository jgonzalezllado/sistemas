sudo apt-get install slapd 
sudo apt-get install ldap-utils -- te instala servidor heredado te permite gestionar
sudo apt-get install phpldapadmin -- nos instala la interfaz para gestionar 

sudo dpkg-reconfigure slapd  -- le da nombre a nuestro dominio

dns julia
julia.server
431992
hacer prueba
nano /etc/phpldapadmin/configi.php   -- es el archivo que modificaremos para trastear el servidor
localizar con control w 'server', 'name'   -- para modificar nombre
'server', 'host' -- aqui se pone la ip
'server', 'base', array --> cambiar example por nuestro server y dc =local en vez de com
'login', 'bind_id'  poner otra vez julia y server  como el anterior ** ojo, que no este comentado**
nuestro login sera admin 
buscar por 1000  y descomentarla y cambiamos por 2000 y 1500

ahora hay que instalar una interficie grafica

sudo apt dist-upgrade
sudo apt install --no-install-recommends lubuntu-desktop
127.0 /phpldapadmin


una vez dentro usr/share/phpldapadmin htdocs lib copiar esas carpetas dentro de home
despues borrarlas con un rm dentro de phpadmin
descomprimir y pasarla a phplapadmin

nuero gid es el grupo 
consola login dejar como bash
crear unidad organizzativa, grupo y usuario

comando equivalente a gpresult

desde terminal habiendo creado todo

sudo slapcat
127.0.0.1
sudo apt install --no-install-recommends lubuntu-desktop login

https://eltallerdelbit.com/cambiar-ip-en-ubuntu/




1.configurar una ip
2. Modificar archivos llamado base,lif y otro que se llama content.lift  -- diferencias en el primero se ponen una serie de codigos para configurarlos, nos da la estructura de mi controladora de dominio. ( si tendra usuarios, ud, etc) despues tendremos el content, que lo que hace permitir crear objetos.
ahi se crean los grupos las ud y los usuarios. Ahí se ponen las credenciales de los usuarios, nombre, contraseña , grupo al que pertenece, la shell que usa... 

meter en la maquina una tarjeta de red, una NAT y otra adaptador interno

hay que darle una ip fija a la red, 192.168.0.1 ( nos inventamos una)
esto se configura en el servidor.

-- en la maquina cliente se añade otra interfaz y ponemos la ip del servidor.



sudo ifconfig enp0s8 up

ifconfig 192.168.0.1 255.255.255.0
hay que hacerlo tanto en cliente server

sudo nano /etc/hosts 
debajo de las ip poner ip de nuestro server y luego julia.server

--configurar servidor hererdado sin phpadmin

sudo slapcat para que salga la info que tengamos

ahora vamos al paso 1

definimos nuestra estructura
sudo nano base.ldif

dn: ou=usuarios,dc=julia,dc=server
objectClass: organizationalUnit
objectclass: top
ou:usuarios

dn: ou=grupos,dc=julia,dc=server
objectClass: organizationalUnit
objectClass: top
ou:grupos


ahora habría que comprobarlo

sudo ldapadd -x -D cn=admin,dc=julia,dc=server -W -f base.ldif

es poner tu contraseña y si te sale adding new entry esq esta todo ok

--------------------

ahora hay que modificar el content

sudo nano content.ldif

copiamos ahi el siguiente codigo

dn: cn:alumnes,ou=grupos,dc=julia,dc=server
objectClass: posixGroup
cn: alumnes
gidNumber: 10000
memberUID: alumnes

dn: uid= joan,ou= usuarios,dc= julia,dc= server
objectClass: inetOrgPerson
objectClass: posixAccount
objectClass: shadowAccount
cn: joan
sn: asix
userPassword: 12345
loginShell: /bin/bash
uidNumber: 2002
gidNumber: 10000
homeDirectory: /home/joan



*habria que cifrar la contraseña en realidad*

ahora ponemos sudo ldapadd -x -D cn=admin,dc=julia,dc=server -W -f content.ldif

si nos da error uno entramos y borramos el que haya ido bien.
fijamos en espacio, despues de los : tiene que haber espacio

